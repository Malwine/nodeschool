<!DOCTYPE html>
<html>
<body>

<p>A script on this page starts this clock:</p>

<form id="timerForm" action="">
  <label>Timer - Minuten einstellen:</label>
  <input id="minutes" type="text" name="minutes" value="0"><br>
  <input type="submit" value="Start">
</form>

<button id="resetButton" type="button" name="button">Reset</button>
<h2>Du hast noch <strong id="minutes-left"></strong> Minuten</h2>

<script>
var running = false;

function getSecondsRemaining(seconds) {
    return seconds - 1;
}

function countdown(event) {
    event.preventDefault();
    const minutes = window.document.getElementById('minutes').value;
    let seconds = minutes * 60;
    const input = window.document.getElementById('minutes-left');
    input.innerHTML = `${minutes} : 00`;
    console.log(`seconds: ${seconds}`);

    const updateTime = function intervalFunc() {
        if (seconds <= 4) {
            window.document.body.style.background = '#ff0000';
        }

        if (seconds <= 0) {
            clearInterval(interval);
            running = false;
        } else {
            running = true;
            const t = getSecondsRemaining(seconds);
            seconds = t;
            console.log(`time remaining: ${t}`);
            const minutesLeft = window.document.getElementById('minutes-left');
            const printMinutes = Math.floor(t / 60);
            const printSeconds = ('0' + (Math.round(t % 60))).slice(-2);
            const remainingTime = `${printMinutes} : ${printSeconds}`;
            minutesLeft.innerHTML = remainingTime;
        }
    };

    const interval = setInterval(updateTime, 1000);

    console.log(`Interval: ${interval}`);
}

function runCountdown(event){
  console.log(running);
  if (running == false) {
    countdown(event);
    console.log("countdown runs");
  }
  else {
    console.log("runs already");
  }
}

function reset(event) {
    window.document.body.style.background = '#FFFFFF';
    window.document.getElementById('minutes').value = 0;
    runCountdown(event); // this shouldn't be here, but funny enough it exactly does what I want now but I want this to happen on the submit button not on reset
}

const timerElement = window.document.getElementById('timerForm');
timerElement.addEventListener('submit', runCountdown);

const resetButton = window.document.getElementById('resetButton');
resetButton.addEventListener('click', reset);

</script>

</body>
</html>
